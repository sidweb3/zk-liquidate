  useEffect(() => {
    if (!authLoading && isAuthenticated) {
      const redirect = redirectAfterAuth || "/";
      navigate(redirect);
    }
  }, [authLoading, isAuthenticated, navigate, redirectAfterAuth]);

  users: defineTable({
    name: v.optional(v.string()), // name of the user. do not remove
    image: v.optional(v.string()), // image of the user. do not remove
    email: v.optional(v.string()), // email of the user. do not remove
    emailVerificationTime: v.optional(v.number()), // email verification time. do not remove
    isAnonymous: v.optional(v.boolean()), // is the user anonymous. do not remove

    role: v.optional(roleValidator), // role of the user. do not remove
  }).index("email", ["email"]), // index for the email. do not remove or modify

  const dbUser = await ctx.db
    .query("users")
    .withIndex("email", (q) => q.eq("email", user.email))
    .first();